<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<meta property="og:title" content="dpp::request_concurrency_queue Class Reference - D++ - The lightweight C++ Discord API Library">
<meta property="og:description" content="A lightweight C++ Discord API library supporting the entire Discord API, including Slash Commands, Voice/Audio, Sharding, Clustering and more!">
<meta name="description" content="dpp::request_concurrency_queue Class Reference - D++ - A lightweight C++ Discord API library supporting the entire Discord API, including Slash Commands, Voice/Audio, Sharding, Clustering and more!">
<meta property="og:image" content="https://dpp.dev/DPP-Logo.png">
<meta property="og:url" content="https://dpp.dev/">
<meta property="og:type" content="website">
<meta property="twitter:title" content="dpp::request_concurrency_queue Class Reference - D++ - The lightweight C++ Discord API Library">
<title>dpp::request_concurrency_queue Class Reference - D++ - The lightweight C++ Discord API Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<script>
	setTimeout(function() {
		$("#main-menu").html($("#main-menu").html() + "<li><select name='vsv' onchange='window.location.href=this.options[this.selectedIndex].value'><option value='/'>master</option><option value='/10.1.0/'>10.1.0</option><option value='/10.0.35/'>10.0.35</option><option value='/10.0.34/'>10.0.34</option><option value='/10.0.33/'>10.0.33</option><option value='/10.0.32/'>10.0.32</option><option value='/10.0.31/'>10.0.31</option><option value='/10.0.30/'>10.0.30</option><option value='/10.0.29/'>10.0.29</option><option value='/10.0.28/'>10.0.28</option><option value='/10.0.27/'>10.0.27</option><option value='/10.0.26/'>10.0.26</option><option value='/10.0.25/'>10.0.25</option><option value='/10.0.24/'>10.0.24</option><option value='/10.0.23/'>10.0.23</option><option value='/10.0.22/'>10.0.22</option><option value='/10.0.21/'>10.0.21</option><option value='/10.0.20/'>10.0.20</option><option value='/10.0.19/'>10.0.19</option><option value='/10.0.18/'>10.0.18</option><option value='/10.0.17/'>10.0.17</option><option value='/10.0.16/'>10.0.16</option><option value='/10.0.15/'>10.0.15</option><option value='/10.0.14/'>10.0.14</option><option value='/10.0.13/'>10.0.13</option><option value='/10.0.12/'>10.0.12</option><option value='/10.0.11/'>10.0.11</option><option value='/10.0.10/'>10.0.10</option><option value='/10.0.9/'>10.0.9</option><option value='/10.0.8/'>10.0.8</option><option value='/10.0.7/'>10.0.7</option><option value='/10.0.6/'>10.0.6</option><option value='/10.0.5/'>10.0.5</option><option value='/10.0.4/'>10.0.4</option><option value='/10.0.3/'>10.0.3</option><option value='/10.0.2/'>10.0.2</option><option value='/10.0.1/'>10.0.1</option><option value='/10.0.0/'>10.0.0</option><option value='/9.0.19/'>9.0.19</option><option value='/9.0.18/'>9.0.18</option><option value='/9.0.17/'>9.0.17</option><option value='/9.0.16/'>9.0.16</option><option value='/9.0.15/'>9.0.15</option><option value='/9.0.14/'>9.0.14</option><option value='/9.0.13/'>9.0.13</option><option value='/9.0.12/'>9.0.12</option><option value='/9.0.11/'>9.0.11</option><option value='/9.0.10/'>9.0.10</option><option value='/9.0.9/'>9.0.9</option><option value='/9.0.8/'>9.0.8</option><option value='/9.0.7/'>9.0.7</option><option value='/9.0.6/'>9.0.6</option><option value='/9.0.5/'>9.0.5</option><option value='/9.0.4/'>9.0.4</option><option value='/9.0.3/'>9.0.3</option><option value='/9.0.2/'>9.0.2</option><option value='/9.0.1/'>9.0.1</option><option value='/9.0.0/'>9.0.0</option><option value='/1.0.2/'>1.0.2</option><option value='/1.0.1/'>1.0.1</option><option value='/1.0.0/'>1.0.0</option></select></li>");
	}, 500);
</script>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="DPP-Logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">D++ (DPP)
   </div>
   <div id="projectbrief">C++ Discord API Bot Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<label for="MSearchField" style="display: none">Search</label>
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classdpp_1_1request__concurrency__queue.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classdpp_1_1request__concurrency__queue-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">dpp::request_concurrency_queue Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Represents a timer instance in a pool handling requests to HTTP(S) servers. There are several of these, the total defined by a constant in cluster.cpp, and each one will always receive requests for the same rate limit bucket based on its endpoint portion of the url. This makes rate limit handling reliable and easy to manage. Each of these also has its own mutex, making it thread safe to call and use these from anywhere in the code.  
 <a href="classdpp_1_1request__concurrency__queue.html#details">More...</a></p>

<p><code>#include &lt;queues.h&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for dpp::request_concurrency_queue:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classdpp_1_1request__concurrency__queue__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af40e9db0e57b5b6c7c2f151d65f25796"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#af40e9db0e57b5b6c7c2f151d65f25796">tick_and_deliver_requests</a> (uint32_t index)</td></tr>
<tr class="memdesc:af40e9db0e57b5b6c7c2f151d65f25796"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timer callback.  <a href="classdpp_1_1request__concurrency__queue.html#af40e9db0e57b5b6c7c2f151d65f25796">More...</a><br /></td></tr>
<tr class="separator:af40e9db0e57b5b6c7c2f151d65f25796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2723e99e8b752c2aa98b062e8fa61f60"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#a2723e99e8b752c2aa98b062e8fa61f60">request_concurrency_queue</a> (class <a class="el" href="classdpp_1_1cluster.html">cluster</a> *owner, class <a class="el" href="classdpp_1_1request__queue.html">request_queue</a> *req_q, uint32_t index)</td></tr>
<tr class="memdesc:a2723e99e8b752c2aa98b062e8fa61f60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new concurrency queue object.  <a href="classdpp_1_1request__concurrency__queue.html#a2723e99e8b752c2aa98b062e8fa61f60">More...</a><br /></td></tr>
<tr class="separator:a2723e99e8b752c2aa98b062e8fa61f60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a694f095ad50a8d50f61d08f34e95c1c7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#a694f095ad50a8d50f61d08f34e95c1c7">~request_concurrency_queue</a> ()</td></tr>
<tr class="memdesc:a694f095ad50a8d50f61d08f34e95c1c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the concurrency queue object This will stop the timer.  <a href="classdpp_1_1request__concurrency__queue.html#a694f095ad50a8d50f61d08f34e95c1c7">More...</a><br /></td></tr>
<tr class="separator:a694f095ad50a8d50f61d08f34e95c1c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71bca44c4ee9f5eb29d2970db6533f4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#a71bca44c4ee9f5eb29d2970db6533f4f">terminate</a> ()</td></tr>
<tr class="memdesc:a71bca44c4ee9f5eb29d2970db6533f4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags the queue as terminating This will set the internal atomic bool that indicates this queue is to accept no more requests.  <a href="classdpp_1_1request__concurrency__queue.html#a71bca44c4ee9f5eb29d2970db6533f4f">More...</a><br /></td></tr>
<tr class="separator:a71bca44c4ee9f5eb29d2970db6533f4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87bb1a0d01ab47ef8c06d702e3ab5bfb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#a87bb1a0d01ab47ef8c06d702e3ab5bfb">post_request</a> (std::unique_ptr&lt; <a class="el" href="classdpp_1_1http__request.html">http_request</a> &gt; req)</td></tr>
<tr class="memdesc:a87bb1a0d01ab47ef8c06d702e3ab5bfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post a <a class="el" href="classdpp_1_1http__request.html" title="A HTTP request.">http_request</a> to this queue.  <a href="classdpp_1_1request__concurrency__queue.html#a87bb1a0d01ab47ef8c06d702e3ab5bfb">More...</a><br /></td></tr>
<tr class="separator:a87bb1a0d01ab47ef8c06d702e3ab5bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a7978dcb49759ecf4ddf3ae4309aefb1e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#a7978dcb49759ecf4ddf3ae4309aefb1e">in_index</a> {0}</td></tr>
<tr class="memdesc:a7978dcb49759ecf4ddf3ae4309aefb1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue index.  <a href="classdpp_1_1request__concurrency__queue.html#a7978dcb49759ecf4ddf3ae4309aefb1e">More...</a><br /></td></tr>
<tr class="separator:a7978dcb49759ecf4ddf3ae4309aefb1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7bf7936853ee5e64cc3e7c872b36bb0"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#af7bf7936853ee5e64cc3e7c872b36bb0">terminating</a></td></tr>
<tr class="memdesc:af7bf7936853ee5e64cc3e7c872b36bb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if ending.  <a href="classdpp_1_1request__concurrency__queue.html#af7bf7936853ee5e64cc3e7c872b36bb0">More...</a><br /></td></tr>
<tr class="separator:af7bf7936853ee5e64cc3e7c872b36bb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e19bde512eee94b60709182a2ad81c2"><td class="memItemLeft" align="right" valign="top">class <a class="el" href="classdpp_1_1request__queue.html">request_queue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#a0e19bde512eee94b60709182a2ad81c2">requests</a></td></tr>
<tr class="memdesc:a0e19bde512eee94b60709182a2ad81c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request queue that owns this <a class="el" href="classdpp_1_1request__concurrency__queue.html" title="Represents a timer instance in a pool handling requests to HTTP(S) servers. There are several of thes...">request_concurrency_queue</a>.  <a href="classdpp_1_1request__concurrency__queue.html#a0e19bde512eee94b60709182a2ad81c2">More...</a><br /></td></tr>
<tr class="separator:a0e19bde512eee94b60709182a2ad81c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac522d901bf22402cec49a880a21d5b28"><td class="memItemLeft" align="right" valign="top">class <a class="el" href="classdpp_1_1cluster.html">cluster</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#ac522d901bf22402cec49a880a21d5b28">creator</a></td></tr>
<tr class="memdesc:ac522d901bf22402cec49a880a21d5b28"><td class="mdescLeft">&#160;</td><td class="mdescRight">The cluster that owns this <a class="el" href="classdpp_1_1request__concurrency__queue.html" title="Represents a timer instance in a pool handling requests to HTTP(S) servers. There are several of thes...">request_concurrency_queue</a>.  <a href="classdpp_1_1request__concurrency__queue.html#ac522d901bf22402cec49a880a21d5b28">More...</a><br /></td></tr>
<tr class="separator:ac522d901bf22402cec49a880a21d5b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33f08478684fae201d8ace29810fa2c8"><td class="memItemLeft" align="right" valign="top">std::shared_mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#a33f08478684fae201d8ace29810fa2c8">in_mutex</a></td></tr>
<tr class="memdesc:a33f08478684fae201d8ace29810fa2c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inbound queue mutex thread safety.  <a href="classdpp_1_1request__concurrency__queue.html#a33f08478684fae201d8ace29810fa2c8">More...</a><br /></td></tr>
<tr class="separator:a33f08478684fae201d8ace29810fa2c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae90d8254414082070925fc7ba2956337"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacedpp.html#a8b9ab0b8cf29978147a7df3947cd8f30">dpp::timer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#ae90d8254414082070925fc7ba2956337">in_timer</a></td></tr>
<tr class="memdesc:ae90d8254414082070925fc7ba2956337"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inbound queue timer. The timer is called every second, and when it wakes up it checks for requests pending to be sent in the queue. If there are any requests and we are not waiting on rate limit, it will send them, else it will wait for the rate limit to expire.  <a href="classdpp_1_1request__concurrency__queue.html#ae90d8254414082070925fc7ba2956337">More...</a><br /></td></tr>
<tr class="separator:ae90d8254414082070925fc7ba2956337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f1d6033dd91df0cb5f0cf17c399563e"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, <a class="el" href="structdpp_1_1bucket__t.html">bucket_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#a4f1d6033dd91df0cb5f0cf17c399563e">buckets</a></td></tr>
<tr class="memdesc:a4f1d6033dd91df0cb5f0cf17c399563e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rate-limit bucket counters.  <a href="classdpp_1_1request__concurrency__queue.html#a4f1d6033dd91df0cb5f0cf17c399563e">More...</a><br /></td></tr>
<tr class="separator:a4f1d6033dd91df0cb5f0cf17c399563e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab417c5ee846fc04b9e9bf7bf0712508c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_ptr&lt; <a class="el" href="classdpp_1_1http__request.html">http_request</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#ab417c5ee846fc04b9e9bf7bf0712508c">requests_in</a></td></tr>
<tr class="memdesc:ab417c5ee846fc04b9e9bf7bf0712508c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue of requests to be made. Sorted by <a class="el" href="classdpp_1_1http__request.html#a31cf6b360a893292435ea56b8d6a94c6" title="Endpoint name e.g. /api/users.">http_request::endpoint</a>.  <a href="classdpp_1_1request__concurrency__queue.html#ab417c5ee846fc04b9e9bf7bf0712508c">More...</a><br /></td></tr>
<tr class="separator:ab417c5ee846fc04b9e9bf7bf0712508c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9119a439aa50b6ad4e3882a69fdcbae5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_ptr&lt; <a class="el" href="classdpp_1_1http__request.html">http_request</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdpp_1_1request__concurrency__queue.html#a9119a439aa50b6ad4e3882a69fdcbae5">removals</a></td></tr>
<tr class="memdesc:a9119a439aa50b6ad4e3882a69fdcbae5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Requests to remove after a set amount of time has passed.  <a href="classdpp_1_1request__concurrency__queue.html#a9119a439aa50b6ad4e3882a69fdcbae5">More...</a><br /></td></tr>
<tr class="separator:a9119a439aa50b6ad4e3882a69fdcbae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Represents a timer instance in a pool handling requests to HTTP(S) servers. There are several of these, the total defined by a constant in cluster.cpp, and each one will always receive requests for the same rate limit bucket based on its endpoint portion of the url. This makes rate limit handling reliable and easy to manage. Each of these also has its own mutex, making it thread safe to call and use these from anywhere in the code. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2723e99e8b752c2aa98b062e8fa61f60" name="a2723e99e8b752c2aa98b062e8fa61f60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2723e99e8b752c2aa98b062e8fa61f60">&#9670;&nbsp;</a></span>request_concurrency_queue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dpp::request_concurrency_queue::request_concurrency_queue </td>
          <td>(</td>
          <td class="paramtype">class <a class="el" href="classdpp_1_1cluster.html">cluster</a> *&#160;</td>
          <td class="paramname"><em>owner</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class <a class="el" href="classdpp_1_1request__queue.html">request_queue</a> *&#160;</td>
          <td class="paramname"><em>req_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new concurrency queue object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">owner</td><td>Owning cluster </td></tr>
    <tr><td class="paramname">req_q</td><td>Owning request queue </td></tr>
    <tr><td class="paramname">index</td><td>Queue index number, uniquely identifies this queue for hashing </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a694f095ad50a8d50f61d08f34e95c1c7" name="a694f095ad50a8d50f61d08f34e95c1c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a694f095ad50a8d50f61d08f34e95c1c7">&#9670;&nbsp;</a></span>~request_concurrency_queue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dpp::request_concurrency_queue::~request_concurrency_queue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy the concurrency queue object This will stop the timer. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a87bb1a0d01ab47ef8c06d702e3ab5bfb" name="a87bb1a0d01ab47ef8c06d702e3ab5bfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87bb1a0d01ab47ef8c06d702e3ab5bfb">&#9670;&nbsp;</a></span>post_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dpp::request_concurrency_queue::post_request </td>
          <td>(</td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="classdpp_1_1http__request.html">http_request</a> &gt;&#160;</td>
          <td class="paramname"><em>req</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Post a <a class="el" href="classdpp_1_1http__request.html" title="A HTTP request.">http_request</a> to this queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">req</td><td><a class="el" href="classdpp_1_1http__request.html" title="A HTTP request.">http_request</a> to post. The pointer will be freed when it has been executed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a71bca44c4ee9f5eb29d2970db6533f4f" name="a71bca44c4ee9f5eb29d2970db6533f4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71bca44c4ee9f5eb29d2970db6533f4f">&#9670;&nbsp;</a></span>terminate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dpp::request_concurrency_queue::terminate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flags the queue as terminating This will set the internal atomic bool that indicates this queue is to accept no more requests. </p>

</div>
</div>
<a id="af40e9db0e57b5b6c7c2f151d65f25796" name="af40e9db0e57b5b6c7c2f151d65f25796"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af40e9db0e57b5b6c7c2f151d65f25796">&#9670;&nbsp;</a></span>tick_and_deliver_requests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dpp::request_concurrency_queue::tick_and_deliver_requests </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Timer callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>Index ID for this timer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a4f1d6033dd91df0cb5f0cf17c399563e" name="a4f1d6033dd91df0cb5f0cf17c399563e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f1d6033dd91df0cb5f0cf17c399563e">&#9670;&nbsp;</a></span>buckets</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, <a class="el" href="structdpp_1_1bucket__t.html">bucket_t</a>&gt; dpp::request_concurrency_queue::buckets</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rate-limit bucket counters. </p>

</div>
</div>
<a id="ac522d901bf22402cec49a880a21d5b28" name="ac522d901bf22402cec49a880a21d5b28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac522d901bf22402cec49a880a21d5b28">&#9670;&nbsp;</a></span>creator</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class <a class="el" href="classdpp_1_1cluster.html">cluster</a>* dpp::request_concurrency_queue::creator</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The cluster that owns this <a class="el" href="classdpp_1_1request__concurrency__queue.html" title="Represents a timer instance in a pool handling requests to HTTP(S) servers. There are several of thes...">request_concurrency_queue</a>. </p>

</div>
</div>
<a id="a7978dcb49759ecf4ddf3ae4309aefb1e" name="a7978dcb49759ecf4ddf3ae4309aefb1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7978dcb49759ecf4ddf3ae4309aefb1e">&#9670;&nbsp;</a></span>in_index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dpp::request_concurrency_queue::in_index {0}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Queue index. </p>

</div>
</div>
<a id="a33f08478684fae201d8ace29810fa2c8" name="a33f08478684fae201d8ace29810fa2c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33f08478684fae201d8ace29810fa2c8">&#9670;&nbsp;</a></span>in_mutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_mutex dpp::request_concurrency_queue::in_mutex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inbound queue mutex thread safety. </p>

</div>
</div>
<a id="ae90d8254414082070925fc7ba2956337" name="ae90d8254414082070925fc7ba2956337"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae90d8254414082070925fc7ba2956337">&#9670;&nbsp;</a></span>in_timer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacedpp.html#a8b9ab0b8cf29978147a7df3947cd8f30">dpp::timer</a> dpp::request_concurrency_queue::in_timer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inbound queue timer. The timer is called every second, and when it wakes up it checks for requests pending to be sent in the queue. If there are any requests and we are not waiting on rate limit, it will send them, else it will wait for the rate limit to expire. </p>

</div>
</div>
<a id="a9119a439aa50b6ad4e3882a69fdcbae5" name="a9119a439aa50b6ad4e3882a69fdcbae5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9119a439aa50b6ad4e3882a69fdcbae5">&#9670;&nbsp;</a></span>removals</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::unique_ptr&lt;<a class="el" href="classdpp_1_1http__request.html">http_request</a>&gt; &gt; dpp::request_concurrency_queue::removals</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Requests to remove after a set amount of time has passed. </p>

</div>
</div>
<a id="a0e19bde512eee94b60709182a2ad81c2" name="a0e19bde512eee94b60709182a2ad81c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e19bde512eee94b60709182a2ad81c2">&#9670;&nbsp;</a></span>requests</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class <a class="el" href="classdpp_1_1request__queue.html">request_queue</a>* dpp::request_concurrency_queue::requests</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request queue that owns this <a class="el" href="classdpp_1_1request__concurrency__queue.html" title="Represents a timer instance in a pool handling requests to HTTP(S) servers. There are several of thes...">request_concurrency_queue</a>. </p>

</div>
</div>
<a id="ab417c5ee846fc04b9e9bf7bf0712508c" name="ab417c5ee846fc04b9e9bf7bf0712508c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab417c5ee846fc04b9e9bf7bf0712508c">&#9670;&nbsp;</a></span>requests_in</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::unique_ptr&lt;<a class="el" href="classdpp_1_1http__request.html">http_request</a>&gt; &gt; dpp::request_concurrency_queue::requests_in</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Queue of requests to be made. Sorted by <a class="el" href="classdpp_1_1http__request.html#a31cf6b360a893292435ea56b8d6a94c6" title="Endpoint name e.g. /api/users.">http_request::endpoint</a>. </p>

</div>
</div>
<a id="af7bf7936853ee5e64cc3e7c872b36bb0" name="af7bf7936853ee5e64cc3e7c872b36bb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7bf7936853ee5e64cc3e7c872b36bb0">&#9670;&nbsp;</a></span>terminating</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;bool&gt; dpp::request_concurrency_queue::terminating</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>True if ending. </p>

</div>
</div>
</div><!-- contents --><script src="https://giscus.app/client.js" data-repo="brainboxdotcc/dpp-comments" data-repo-id="R_kgDOHOY4xg" data-category="General" data-category-id="DIC_kwDOHOY4xs4CRYtj" data-mapping="pathname" data-strict="1" data-reactions-enabled="1" data-emit-metadata="1" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" data-loading="lazy" crossorigin="anonymous" async></script>
</div><!-- doc-content -->
<div id="nav-path" class="navpath">
	<ul>
		<li class="navelem"><a class="el" href="namespacedpp.html">dpp</a></li><li class="navelem"><a class="el" href="classdpp_1_1request__concurrency__queue.html">request_concurrency_queue</a></li>
	</ul>
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QTH6YHBNG5"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/base16/dracula.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@100&display=swap" rel="stylesheet">
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-QTH6YHBNG5');
	$(function() {
		$(".fragment").each(function(i,node) {
			var $node = $(node);
			$node.children(":not(.line)").remove();
			$node.html("<pre><code class='stan'>" + $node.text().trim().replaceAll("<", "&lt;").replaceAll(">", "&gt;") + "</code></pre>");
			hljs.configure({
				languages: ['cpp','diff','cmake','bash','sh','text'],
				ignoreUnescapedHTML: true
			});
			hljs.highlightAll(node);
			hljs.initLineNumbersOnLoad(node);  
		});
		$(".fragment").parent().parent().parent().parent().removeClass('doxtable');
	});
</script>
<style>
	.hljs-ln-code, code, code a, pre.fragment, div.fragment, div.fragment .line, div.fragment span, div.fragment .line a, div.fragment .line span {
		font-family: 'JetBrains Mono', monospace !important;
		font-size: 0.8rem !important;
	}
	.fragment {
		padding: 0 !important;
		margin-top: 0 !important;
		margin-bottom: 0 !important;
		background: none !important;
		border: 0 !important;
	}
	.hljs-ln-n::before {
		content: attr(data-line-number);
		padding-right: 1rem !important;
	}
	table.markdownTable code td, table.markdownTable code th, table.fieldtable code td, table.fieldtable code th, table.doxtable code td, table.doxtable code th {
		border: 0 !important;
		padding: 0 !important;
	}	
</style>
<div style="z-index: -9999; position: absolute; right: 0; top: 0; font-size: 0.0001rem;color:transparent;background:none">
	<!-- For crawlability of past versions -->
	<a href='/10.1.0/'>D++ Library version 10.1.0</a><a href='/10.0.35/'>D++ Library version 10.0.35</a><a href='/10.0.34/'>D++ Library version 10.0.34</a><a href='/10.0.33/'>D++ Library version 10.0.33</a><a href='/10.0.32/'>D++ Library version 10.0.32</a><a href='/10.0.31/'>D++ Library version 10.0.31</a><a href='/10.0.30/'>D++ Library version 10.0.30</a><a href='/10.0.29/'>D++ Library version 10.0.29</a><a href='/10.0.28/'>D++ Library version 10.0.28</a><a href='/10.0.27/'>D++ Library version 10.0.27</a><a href='/10.0.26/'>D++ Library version 10.0.26</a><a href='/10.0.25/'>D++ Library version 10.0.25</a><a href='/10.0.24/'>D++ Library version 10.0.24</a><a href='/10.0.23/'>D++ Library version 10.0.23</a><a href='/10.0.22/'>D++ Library version 10.0.22</a><a href='/10.0.21/'>D++ Library version 10.0.21</a><a href='/10.0.20/'>D++ Library version 10.0.20</a><a href='/10.0.19/'>D++ Library version 10.0.19</a><a href='/10.0.18/'>D++ Library version 10.0.18</a><a href='/10.0.17/'>D++ Library version 10.0.17</a><a href='/10.0.16/'>D++ Library version 10.0.16</a><a href='/10.0.15/'>D++ Library version 10.0.15</a><a href='/10.0.14/'>D++ Library version 10.0.14</a><a href='/10.0.13/'>D++ Library version 10.0.13</a><a href='/10.0.12/'>D++ Library version 10.0.12</a><a href='/10.0.11/'>D++ Library version 10.0.11</a><a href='/10.0.10/'>D++ Library version 10.0.10</a><a href='/10.0.9/'>D++ Library version 10.0.9</a><a href='/10.0.8/'>D++ Library version 10.0.8</a><a href='/10.0.7/'>D++ Library version 10.0.7</a><a href='/10.0.6/'>D++ Library version 10.0.6</a><a href='/10.0.5/'>D++ Library version 10.0.5</a><a href='/10.0.4/'>D++ Library version 10.0.4</a><a href='/10.0.3/'>D++ Library version 10.0.3</a><a href='/10.0.2/'>D++ Library version 10.0.2</a><a href='/10.0.1/'>D++ Library version 10.0.1</a><a href='/10.0.0/'>D++ Library version 10.0.0</a><a href='/9.0.19/'>D++ Library version 9.0.19</a><a href='/9.0.18/'>D++ Library version 9.0.18</a><a href='/9.0.17/'>D++ Library version 9.0.17</a><a href='/9.0.16/'>D++ Library version 9.0.16</a><a href='/9.0.15/'>D++ Library version 9.0.15</a><a href='/9.0.14/'>D++ Library version 9.0.14</a><a href='/9.0.13/'>D++ Library version 9.0.13</a><a href='/9.0.12/'>D++ Library version 9.0.12</a><a href='/9.0.11/'>D++ Library version 9.0.11</a><a href='/9.0.10/'>D++ Library version 9.0.10</a><a href='/9.0.9/'>D++ Library version 9.0.9</a><a href='/9.0.8/'>D++ Library version 9.0.8</a><a href='/9.0.7/'>D++ Library version 9.0.7</a><a href='/9.0.6/'>D++ Library version 9.0.6</a><a href='/9.0.5/'>D++ Library version 9.0.5</a><a href='/9.0.4/'>D++ Library version 9.0.4</a><a href='/9.0.3/'>D++ Library version 9.0.3</a><a href='/9.0.2/'>D++ Library version 9.0.2</a><a href='/9.0.1/'>D++ Library version 9.0.1</a><a href='/9.0.0/'>D++ Library version 9.0.0</a><a href='/1.0.2/'>D++ Library version 1.0.2</a><a href='/1.0.1/'>D++ Library version 1.0.1</a><a href='/1.0.0/'>D++ Library version 1.0.0</a>
</div>
</body>
</html>
