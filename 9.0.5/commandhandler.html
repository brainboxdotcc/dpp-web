<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<meta property="og:title" content="Using a command handler object - D++ - The lightweight C++ Discord API Library">
<meta property="og:description" content="A lightweight C++ Discord API library supporting the entire Discord API, including Slash Commands, Voice/Audio, Sharding, Clustering and more!">
<meta name="description" content="Using a command handler object - D++ - A lightweight C++ Discord API library supporting the entire Discord API, including Slash Commands, Voice/Audio, Sharding, Clustering and more!">
<meta property="og:image" content="https://dpp.dev/DPP-Logo.png">
<meta property="og:url" content="https://dpp.dev/">
<meta property="og:type" content="website">
<meta property="twitter:title" content="Using a command handler object - D++ - The lightweight C++ Discord API Library">
<title>Using a command handler object - D++ - The lightweight C++ Discord API Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<script>
	setTimeout(function() {
		$("#main-menu").html($("#main-menu").html() + "<li><select name='vsv' onchange='window.location.href=this.options[this.selectedIndex].value'><option value='/'>master</option><option value='/9.0.11/'>9.0.11</option><option value='/9.0.10/'>9.0.10</option><option value='/9.0.9/'>9.0.9</option><option value='/9.0.8/'>9.0.8</option><option value='/9.0.7/'>9.0.7</option><option value='/9.0.6/'>9.0.6</option><option selected value='/9.0.5/'>9.0.5</option><option value='/9.0.4/'>9.0.4</option><option value='/9.0.3/'>9.0.3</option><option value='/9.0.2/'>9.0.2</option><option value='/9.0.1/'>9.0.1</option><option value='/9.0.0/'>9.0.0</option><option value='/1.0.2/'>1.0.2</option><option value='/1.0.1/'>1.0.1</option><option value='/1.0.0/'>1.0.0</option></select></li>");
	}, 500);
</script>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="DPP-Logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">D++ (DPP)
   </div>
   <div id="projectbrief">A Lightweight C++ library for Discord</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<label for="MSearchField" style="display: none">Search</label>
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('commandhandler.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Using a command handler object </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >If you have many commands in your bot, and want to handle commands from multiple sources (for example modern slash commands, and more regular prefixed channel messages) you should consider instantiating a <a class="el" href="classdpp_1_1commandhandler.html" title="The commandhandler class represents a group of commands, prefixed or slash commands with handling fun...">dpp::commandhandler</a> object. This object can be used to automatically route commands and their parameters to functions in your program. A simple example of using this object to route commands is shown below, and will route both the /ping (global slash command) and .ping (prefixed channel message command) to a lambda where a reply can be generated.</p>
<dl class="section note"><dt>Note</dt><dd>This example automatically hooks the <a class="el" href="classdpp_1_1cluster.html#aaaafcd2c26fe588021454ee3d0d0fec8" title="Called when a new message arrives from discord. Note that D++ does not cache messages....">dpp::cluster::on_message_create</a> and <a class="el" href="classdpp_1_1cluster.html#a3287881d5f1aba46a7013c695b69a591" title="Called when a new interaction is created. Interactions are created by discord when commands you have ...">dpp::cluster::on_interaction_create</a> events. This can be overridden if needed to allow you to still make use of these functions for your own code, if you need to do this please see the constructor documentation for <a class="el" href="classdpp_1_1commandhandler.html" title="The commandhandler class represents a group of commands, prefixed or slash commands with handling fun...">dpp::commandhandler</a>.</dd></dl>
<p>Note that because the <a class="el" href="classdpp_1_1commandhandler.html#a791ed0c75ef77306af84be30ded619f8" title="Add a command to the command handler.">dpp::commandhandler::add_command</a> method accepts a std::function as the command handler, you may point a command handler at a simple lambda (as shown in this example), a function pointer, or an instantiated class method of an object. This is extremely flexible and allows you to decide how and where commands should be routed, either to an object oriented system or to a lambda based system.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;dpp/dpp.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_class" href="classdpp_1_1cluster.html">dpp::cluster</a> bot(<span class="stringliteral">&quot;token&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Create command handler, and specify prefixes */</span></div>
<div class="line">    <a class="code hl_class" href="classdpp_1_1commandhandler.html">dpp::commandhandler</a> <a class="code hl_typedef" href="namespacedpp.html#a72a8ab3231965d0e361f305a7fe431f3">command_handler</a>(&amp;bot);</div>
<div class="line">    <span class="comment">/* Specifying a prefix of &quot;/&quot; tells the command handler it should also expect slash commands */</span></div>
<div class="line">    <a class="code hl_typedef" href="namespacedpp.html#a72a8ab3231965d0e361f305a7fe431f3">command_handler</a>.add_prefix(<span class="stringliteral">&quot;.&quot;</span>).add_prefix(<span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    bot.on_ready([&amp;command_handler](<span class="keyword">const</span> <a class="code hl_struct" href="structdpp_1_1ready__t.html">dpp::ready_t</a> &amp;event) {</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_typedef" href="namespacedpp.html#a72a8ab3231965d0e361f305a7fe431f3">command_handler</a>.add_command(</div>
<div class="line">            <span class="comment">/* Command name */</span></div>
<div class="line">            <span class="stringliteral">&quot;ping&quot;</span>,</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Parameters */</span></div>
<div class="line">            {</div>
<div class="line">                {<span class="stringliteral">&quot;testparameter&quot;</span>, <a class="code hl_struct" href="structdpp_1_1param__info.html">dpp::param_info</a>(<a class="code hl_enumvalue" href="namespacedpp.html#a9a2049904620e4f62b82f8dc818de864a36958c192951cad2ae2b921de3db644a">dpp::pt_string</a>, <span class="keyword">true</span>, <span class="stringliteral">&quot;Optional test parameter&quot;</span>) }</div>
<div class="line">            },</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Command handler */</span></div>
<div class="line">            [&amp;<a class="code hl_typedef" href="namespacedpp.html#a72a8ab3231965d0e361f305a7fe431f3">command_handler</a>](<span class="keyword">const</span> std::string&amp; command, <span class="keyword">const</span> <a class="code hl_typedef" href="namespacedpp.html#a632b6ae7b47a5feb95104644a487e4f1">dpp::parameter_list_t</a>&amp; parameters, <a class="code hl_struct" href="structdpp_1_1command__source.html">dpp::command_source</a> src) {</div>
<div class="line">                std::string got_param;</div>
<div class="line">                <span class="keywordflow">if</span> (!parameters.empty()) {</div>
<div class="line">                    got_param = std::get&lt;std::string&gt;(parameters[0].second);</div>
<div class="line">                }</div>
<div class="line">                <a class="code hl_typedef" href="namespacedpp.html#a72a8ab3231965d0e361f305a7fe431f3">command_handler</a>.reply(<a class="code hl_struct" href="structdpp_1_1message.html">dpp::message</a>(<span class="stringliteral">&quot;Pong! -&gt; &quot;</span> + got_param), src);</div>
<div class="line">            },</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Command description */</span></div>
<div class="line">            <span class="stringliteral">&quot;A test ping command&quot;</span>,</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Guild id (omit for a global command) */</span></div>
<div class="line">            819556414099554344</div>
<div class="line">        );</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* NOTE: We must call this to ensure slash commands are registered.</span></div>
<div class="line"><span class="comment">         * This does a bulk register, which will replace other commands</span></div>
<div class="line"><span class="comment">         * that are registered already!</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <a class="code hl_typedef" href="namespacedpp.html#a72a8ab3231965d0e361f305a7fe431f3">command_handler</a>.register_commands();</div>
<div class="line"> </div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    bot.start(<span class="keyword">false</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassdpp_1_1cluster_html"><div class="ttname"><a href="classdpp_1_1cluster.html">dpp::cluster</a></div><div class="ttdoc">The cluster class represents a group of shards and a command queue for sending and receiving commands...</div><div class="ttdef"><b>Definition:</b> cluster.h:235</div></div>
<div class="ttc" id="aclassdpp_1_1commandhandler_html"><div class="ttname"><a href="classdpp_1_1commandhandler.html">dpp::commandhandler</a></div><div class="ttdoc">The commandhandler class represents a group of commands, prefixed or slash commands with handling fun...</div><div class="ttdef"><b>Definition:</b> commandhandler.h:190</div></div>
<div class="ttc" id="anamespacedpp_html_a632b6ae7b47a5feb95104644a487e4f1"><div class="ttname"><a href="namespacedpp.html#a632b6ae7b47a5feb95104644a487e4f1">dpp::parameter_list_t</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; std::string, command_parameter &gt; &gt; parameter_list_t</div><div class="ttdoc">Parameter list for a called command. See dpp::parameter_registration_t for an explanation as to why v...</div><div class="ttdef"><b>Definition:</b> commandhandler.h:127</div></div>
<div class="ttc" id="anamespacedpp_html_a72a8ab3231965d0e361f305a7fe431f3"><div class="ttname"><a href="namespacedpp.html#a72a8ab3231965d0e361f305a7fe431f3">dpp::command_handler</a></div><div class="ttdeci">std::function&lt; void(const std::string &amp;, const parameter_list_t &amp;, command_source)&gt; command_handler</div><div class="ttdoc">The function definition for a command handler. Expects a command name string, and a list of command p...</div><div class="ttdef"><b>Definition:</b> commandhandler.h:164</div></div>
<div class="ttc" id="anamespacedpp_html_a9a2049904620e4f62b82f8dc818de864a36958c192951cad2ae2b921de3db644a"><div class="ttname"><a href="namespacedpp.html#a9a2049904620e4f62b82f8dc818de864a36958c192951cad2ae2b921de3db644a">dpp::pt_string</a></div><div class="ttdeci">@ pt_string</div><div class="ttdoc">String value.</div><div class="ttdef"><b>Definition:</b> commandhandler.h:65</div></div>
<div class="ttc" id="astructdpp_1_1command__source_html"><div class="ttname"><a href="structdpp_1_1command__source.html">dpp::command_source</a></div><div class="ttdoc">Represents the sending source of a command. This is passed to any command handler and should be passe...</div><div class="ttdef"><b>Definition:</b> commandhandler.h:137</div></div>
<div class="ttc" id="astructdpp_1_1message_html"><div class="ttname"><a href="structdpp_1_1message.html">dpp::message</a></div><div class="ttdoc">Represents messages sent and received on Discord.</div><div class="ttdef"><b>Definition:</b> message.h:944</div></div>
<div class="ttc" id="astructdpp_1_1param__info_html"><div class="ttname"><a href="structdpp_1_1param__info.html">dpp::param_info</a></div><div class="ttdoc">Details of a command parameter used in registration. Note that for non-slash commands optional parame...</div><div class="ttdef"><b>Definition:</b> commandhandler.h:79</div></div>
<div class="ttc" id="astructdpp_1_1ready__t_html"><div class="ttname"><a href="structdpp_1_1ready__t.html">dpp::ready_t</a></div><div class="ttdoc">Session ready.</div><div class="ttdef"><b>Definition:</b> dispatcher.h:432</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="md_docpages_03_example_programs.html">Example Programs</a></li>
  </ul>
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QTH6YHBNG5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
        gtag('config', 'G-QTH6YHBNG5');
</script>
<div style="z-index: -9999; position: absolute; right: 0; top: 0; font-size: 0.0001rem;color:transparent;background:none">
	<!-- For crawlability of past versions -->
	<a href='/9.0.11/'>D++ Library version 9.0.11</a><a href='/9.0.10/'>D++ Library version 9.0.10</a><a href='/9.0.9/'>D++ Library version 9.0.9</a><a href='/9.0.8/'>D++ Library version 9.0.8</a><a href='/9.0.7/'>D++ Library version 9.0.7</a><a href='/9.0.6/'>D++ Library version 9.0.6</a><a href='/9.0.5/'>D++ Library version 9.0.5</a><a href='/9.0.4/'>D++ Library version 9.0.4</a><a href='/9.0.3/'>D++ Library version 9.0.3</a><a href='/9.0.2/'>D++ Library version 9.0.2</a><a href='/9.0.1/'>D++ Library version 9.0.1</a><a href='/9.0.0/'>D++ Library version 9.0.0</a><a href='/1.0.2/'>D++ Library version 1.0.2</a><a href='/1.0.1/'>D++ Library version 1.0.1</a><a href='/1.0.0/'>D++ Library version 1.0.0</a>
</div>
</body>
</html>
